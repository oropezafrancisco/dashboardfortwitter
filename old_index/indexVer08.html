<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Frontend Coding Challenge</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
        <link rel="stylesheet" type="text/css" href="stylesV02.css">
        <script src="/reload/reload.js"></script>
    </head>
<body>

<script>
//def Var
var arrayTwitter = [];
var tuis;
var peoples;
var timeOfRefresh;
//def Var
function readVar(tuisR, timeOfRefresh)
{
  var tuisR = 30;
  var timeOfRefreshR = "60";
  return [tuisR, timeOfRefreshR];
}

// start urlify
function urlify(text) {
var urlRegex = /(https?:\/\/[^\s]+)/g;
  return text.replace(urlRegex, function(url) {
      return '<a href="' + url + '">' + url + '</a>';
  });
};
// end urlify

//Table Master ************* function
function madetable1(u1,u2)
{
var x = document.createElement("table")
{
var y = document.createElement("tr")
{ for (var i = 0; i < u1; i++)
{
  {
          var z = document.createElement("th")
            {
              var w = document.createElement("cell");
              w.innerHTML = "";
              w.setAttribute("id","TitleNombre0"+i);
              z.setAttribute("id","TitleZ");
              z.appendChild(w);
            };
          y.setAttribute("id","TitleY"+i);
          y.appendChild(z);
        };
    };

};
x.setAttribute("id","TitleX"+i);
x.appendChild(y);
};
{
var y = document.createElement("tr")
{ for (var i = 0; i < u1; i++)
{
  {
          var z = document.createElement("th")
            {
              var w = document.createElement("cell");
              w.innerHTML = "";
              w.setAttribute("id","Column0"+i);
              z.setAttribute("id","TheZ");
              z.appendChild(w);
            };
          y.setAttribute("id","TheY"+i);
          y.appendChild(z);
        };
    };

};
x.setAttribute("id","TheX"+i);
x.appendChild(y);
};
var divContainer4 = document.getElementById(u2);
x.setAttribute("id","t001");
divContainer4.appendChild(x);
};
// End table Master funcion

</script>

<meta id="meta01" http-equiv="Refresh" >
<script>
var d = readVar(tuis,timeOfRefresh);
var tuis =d[0];
var timeOfRefresh =d[1];
</script>

<script>document.getElementById("meta01").setAttribute("content", timeOfRefresh)</script>
<!-- main -->
<div id="body01"></div>

<!-- end main -->

<script>






// star NAME search
$.getJSON('listNameTwitter.json', function (data) {

                $.each(data, function (index, value) {
                      arrayTwitter.push(value);
                });

                var col = [];
                for (var i = 0; i < arrayTwitter.length; i++) {
                    for (var key in arrayTwitter[i]) {
                        if (col.indexOf(key) === -1) { col.push(key) }
                    }
                };
                //Table Master *************


                madetable1(arrayTwitter.length,"body01");//Table Master *************


                //Table Master *************

                for (var i = 0; i < arrayTwitter.length; i++) {
                  var divContainer = document.getElementById("TitleNombre0"+i);
                  divContainer.innerHTML = "@"+arrayTwitter[i];


                };


//init cicle columns*******************
for (var k = 0; k < arrayTwitter.length; k++) {

          $(document).ready(function () {
//zona var*************************
              var url1="http://localhost:7890/1.1/statuses/user_timeline.json?count="+tuis+"&screen_name="+arrayTwitter[k];
              var arrItems = [];
              var table2 = document.createElement("table");
              table2.setAttribute("id","t002");
//zona var END****************
              $.getJSON(url1, function (data) {


                  $.each(data, function (index, value) { arrItems.push(value) });

                  var col = [];
                  for (var i = 0; i < arrItems.length; i++) {
                      for (var key in arrItems[i]) {
                          if (col.indexOf(key) === -1) { col.push(key) };
                      };
                  };


                  var tr = table2.insertRow(-1)
                  {
                      var th = document.createElement("th");
                      th.innerHTML = col[0];
                      th.setAttribute("id","thtitle");
                      tr.appendChild(th);
                      var th = document.createElement("th");
                      th.innerHTML = col[3];
                      th.setAttribute("id","thtitle");
                      tr.appendChild(th);
                      var th = document.createElement("th");
                      th.innerHTML = col[6];
                      th.setAttribute("id","thtitle");
                      tr.appendChild(th);
                  };


                  for (var i = 0; i < arrItems.length; i++)
                  { tr = table2.insertRow(-1);
                      {
                          var tabCell = tr.insertCell(-1);
                          tabCell.setAttribute("id","timedate");
                          var d1 = new Date(arrItems[i][col[0]]);
                          var d2 = d1.toDateString();
                          tabCell.innerHTML = d1.toUTCString();
                          var tabCell = tr.insertCell(-1);
                          tabCell.setAttribute("id","thcontant");
                          tabCell.innerHTML = urlify(arrItems[i][col[3]]);
                          var tabCell = tr.insertCell(-1);
                          tabCell.setAttribute("id","thcontant");
                          tabCell.innerHTML = arrItems[i][col[6]];
                      }
                  };



              });

              var divContainer9 = document.getElementById("Column0"+k);
              divContainer9.innerHTML = '';
              divContainer9.appendChild(table2);

          });

//****************** push here end for************* eye *************
      };
//****************** end for************* eye *************
//***********************************************************
//autoRefresh END

//autoRefresh END
//************************************************************
//****************** end NAME search************* eye *************


});
//****************** end NAME search************* eye *************

</script>

</body>

</html>
